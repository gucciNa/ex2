# 2種類のゲーム
## ゲームの選択
Raspberry Piに電源ケーブルを接続すると，最初にメニューのプログラムが実行される．ここでは実行するゲームの選択を行う．ここで選択できるのは，5曲分のリズムゲームから1曲分または反射神経ゲームの6種類である．ディスプレイの下部から上部へと，選択するリズムゲームの曲名またはゲーム名を示すカタカナ表記の文字が流れ，同時にそのゲームで使用される曲のデモサウンドが演奏される．スイッチ4(右上)を押していくと，リズムゲームの「前前前世」，「ウミユリ海底譚」，「からくりピエロ」，「アイネクライネ」，「凛として咲く花の如く」の順に表示され，最後に反射神経ゲームが「ハラペコオバケ」として表示される．ディスプレイに文字が流れている途中でも，デモサウンドが演奏されている途中でも，スイッチを押せば次のゲーム選択が表示される．最後まで表示されたときにスイッチ4（右上）を押すと，再び「前前前世」からゲーム選択が表示される．また，スイッチ3（左上）を押すことで1つ前のゲーム選択に戻ることができる．プレイするゲームはスイッチ1（左下）を押して決定する．
##つまり
右上のボタンで次の曲へ<br>
左上のボタンで前の曲へ<br>
左下のボタンで決定
### プログラムの説明
##リズムゲーム
### 遊び方
メニューから「前前前世」（難易度Normal），「ウミユリ海底譚」（難易度Hard），「からくりピエロ」（難易度Easy），「アイネクライネ」（難易度Normal），「凛として咲く花の如く」（難易度Very Easy）のいずれかを選択し，ゲームを開始する．
このゲームの目的は，曲の演奏中，ディスプレイの4か所のいずれかまたは同時に表示されるノーツのタイミングに合わせて対応するスイッチを押し，0~100%で表される達成率を高めることである．
曲ごとに，曲の長さやノーツの数，タイミングは異なる．ノーツの表示される個所およびノーツの形状は固定されている．ノーツは渦の形を模している．ノーツの出現後，外側から内側へ9つのディスプレイのランプを点灯させていく．最後の1つである渦の中心が光るタイミングがスイッチを押すタイミングになる．
曲が最後まで演奏されると，出現するノーツの数の内，どれだけタイミングよく押せたかの達成率をディスプレイに表示させる．
また、リザルト画面でスイッチ2（右下）を押すと、最初の選択画面に遷移する.
### プログラムの説明
このリズムゲームを実行するサブルーチンのプログラムは, music_[曲名].sに書いている. タイマーを用いて, 音楽を鳴らすためのサブルーチン, リズムゲームの譜面(ノーツ)の追加を読み込むサブルーチン, ノーツの書き込み及びボタン状態から判定を行うサブルーチン, ディスプレイの表示を行うサブルーチンを使用している. ノーツとスイッチは, 画面の表示に合わせて画面左上の渦と左上に配置されているSW3を対応させている. 他3つも同様の対応を行っている. 渦が8つまたは9つ点灯しているタイミングでスイッチの入力があったとき, 入力は成功したと判定される. 曲が終了したとき, リザルトを行うサブルーチンに飛び, ドラムロール音声を流し, その後ファンファーレと共に達成度を表示する. ドラムロール中は, 疑似乱数もどきの生成により, ランダムな数を画面に表示させている. また、曲終了、すなわちファンファーレ終了後にSW2を入力することによりゲーム選択画面に遷移するようにしている.

## 反射神経ゲーム
### 遊び方
メニューから「ハラペコオバケ」を選択し，ゲームを開始する．
このゲームの目的は，等間隔でディスプレイに表示される図形を判別し，それによってそれぞれ対応するボタンを正しく押してゲームオーバーにならないことである．
ゲームオーバーの条件は下記の通り2つ存在する．

- ディスプレイに食べられるものまたは食べられないものを示す図形が表示されたときに，それぞれに非対応のスイッチを押した場合
- ディスプレイに食べられるものまたは食べられないものを示す図形が表示されたときに，いずれのスイッチも押さず時間が経った場合

ゲーム開始直後は「おもちゃの兵隊の行進曲」の音楽が流れ，キャラクターがディスプレイに表示される．そして約2.5秒後に0.5秒間4種類の図形の内の1つが表示される．表示されたものが，プリンもしくはジュース(下図参照)といった食べものを示す図形だった場合，対応するスイッチ1（左下）を押す．表示されたものが，フォークもしくは太陽(下図参照)といった食べられないものを示す図形だった場合，対応するスイッチ2（右下）を押す．ここで上で記したようなゲームオーバー条件を満たすと，ディスプレイにはゲームオーバー画面が表示され，音楽が流れなくなり，ゲームは終了となる．ゲームオーバーとなる条件を満たさず，正しくディスプレイに表示しされたものに対応したスイッチを押すと，再びキャラクターがディスプレイに表示され，以後同様の時間間隔でゲームが続く．また,ゲームオーバー画面表示時に,スイッチ4（右上）を押すと再びゲームが開始される.スイッチ3（左上）を押した場合は、メニュー画面に戻る.メニューに戻った後,再びこのゲームを開始する場合は,ゲームオーバーの画面から始まるので,スイッチ3（赤色）を押してゲームを開始する必要がある.


![purine.jpg](purine.jpg "プリン(食べられるもの)")*プリン(食べられるもの)*
![juice.jpg](juice.jpg "ジュース(食べられるもの)")*ジュース(食べられるもの)*
![silver.jpg](silver.jpg "フォーク(食べられないもの)")*フォーク(食べられないもの)*
![sun.jpg](sun.jpg "太陽(食べられないもの)")*太陽(食べられないもの)*


### プログラムの説明
このゲームを実行するサブルーチンのプログラムはhungry_ghost.sに書いている．タイマーを用いて，音楽を鳴らすためのサブルーチン，表示させるキャラクターまたはオブジェクトの差分に変更するサブルーチン，時間経過によるゲームオーバー処理のためのサブルーチン，スイッチへの入力を検証し，状況によってディスプレイに表示させるものを変更するサブルーチン，ディスプレイに表示させるサブルーチンを呼び出して処理を行う．ゲームオーバーの条件を満たさない限り，一連の処理を指定した時間に繰り返し行う．ゲームオーバーの条件を満たした後は，ゲームオーバー画面を表示させるためのディスプレイの更新以外の処理は行わない．
また，このプログラムは主記憶領域には，ディスプレイに表示させる図形のデータ，ゲームのプレイ中に鳴らす音楽のデータ，食べられるものまたは食べられないものを示す4種類の図形をどのような順番で表示させるかを示すデータ，時間経過によるゲームオーバーの条件を判定するために必要となる，処理の回数を記録するデータを保存している．
